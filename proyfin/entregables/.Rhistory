ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()+
scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")#+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(breaks = FH_REF[c(T,F,F)])+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete()+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(FH_REF)+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(x)+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(x[c(T,F,F)])+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(as.Date(FH_REF[c(T,F,F)])+theme_minimal()#+scale_x_continuous('mes', labels = FH_REF)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(as.Date(FH_REF)[c(T,F,F)])+theme_minimal()
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
#xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(as.Date(FH_REF)[c(T,F,F)])+theme_minimal()
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
#xlab("Fecha") +
ylab("Creditos contratados")+scale_x_discrete(as.Date(FH_REF)[c(T,F,F)])#+theme_minimal()
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal(axis.text.x = element_text(angle = 90, vjust = 0.5))
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()
View(tot)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target),tasa=target/ID)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target),tasa=(target/ID))
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target))%>%mutate(tasa=(target/ID))
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target),ctes=sum(ID))%>%mutate(tasa=(total/ctes))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()
View(tot)
ggplot(tot,aes(x=as.Date(FH_REF),y=tasa)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Tasa")+theme_minimal()
ggplot(tot,aes(x=as.Date(FH_REF),y=tasa)) + geom_line(col="red") +geom_point()+
xlab("Fecha") +
ylab("Tasa")+theme_minimal()
ggplot(camp, aes(x = as.Date(FH_REF), y = target)) +
geom_line(aes(color = TP_SEGMENTO_FINAL2,
group = TP_SEGMENTO_FINAL2)) + geom_point()+
guides(color = guide_legend(title = "Segmento"))+
ylab('Conteo por Segmento') +
xlab('Fecha') + theme_minimal()
ggplot(camp, aes(x = as.Date(FH_REF), y = target)) +
geom_line(aes(color = TP_SEGMENTO_FINAL2,
group = TP_SEGMENTO_FINAL2)) +
guides(color = guide_legend(title = "Segmento"))+
ylab('Conteo por Segmento') +
xlab('Fecha') + theme_minimal()
ggplot(camp,aes(x=as.Date(FH_REF),y=target)) + geom_line(col="red") +facet_wrap(~TP_SEGMENTO_FINAL2)+
geom_point()+
xlab("Fecha") +
ylab("Creditos colocados")+theme(axis.text.x = element_text(angle=90))
ggplot(camp,aes(x=as.Date(FH_REF),y=target)) + geom_line(col="red") +facet_wrap(~TP_SEGMENTO_FINAL2)+
xlab("Fecha") +
ylab("Creditos colocados")+theme(axis.text.x = element_text(angle=90))
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, ID), y=ID,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()
ggplot(camp, aes(x = as.Date(FH_REF), y = target)) +
geom_line(aes(color = TP_SEGMENTO_FINAL2,
group = TP_SEGMENTO_FINAL2)) +
guides(color = guide_legend(title = "Segmento"))+
ylab('Créditos contratados') +
xlab('Fecha') + theme_minimal()
ggplot(camp,aes(x=as.Date(FH_REF),y=target)) + geom_line(col="red") +facet_wrap(~TP_SEGMENTO_FINAL2)+
xlab("Fecha") +
ylab("Creditos contratados")+theme(axis.text.x = element_text(angle=90))
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, target), y=target,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()+xlab('Segmento')
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, target), y=target,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()+xlab('Segmento')+ylab('Créditos contratados')
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, ID), y=ID,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()+xlab('Segmento')+ylab('Número de Clientes')
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%
summarise(mediana = median(target),
promedio = mean(target))  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%mutate(tasa=(target/ID))
summarise(mediana = median(target),
promedio = mean(target),tasa_promedio=mean(tasa))  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%mutate(tasa=(target/ID))%>%
summarise(mediana = median(target),
promedio = mean(target),tasa_promedio=mean(tasa))  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%mutate(tasa=(target/ID))%>%
summarise(mediana = median(target),
promedio = mean(target),tasa_promedio=mean(tasa)*100)  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%mutate(tasa=(target/ID))%>%
summarise(mediana = median(target),
promedio = mean(target),tasa_promedio=mean(tasa)*100)  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
names(camp)
library(corrplot)
nums <- unlist(lapply(camp, is.numeric))
nums
corrplot(cor(camp[,nums]))
camp
pairs(camp[,nums])
library(corrplot)
campx<-camp
View(campx)
campx$FH_REF<-as.Date(campx$FH_REF)
nums <- unlist(lapply(camp, is.numeric))
nums
campx$FH_REF<-as.numeric(campx$FH_REF)
nums <- unlist(lapply(camp, is.numeric))
nums
nums <- unlist(lapply(campx, is.numeric))
nums
campx$FH_REF<-as.Date(campx$FH_REF)
campx<-camp
campx$FH_REF<-as.Date(campx$FH_REF)
nums <- unlist(lapply(campx, is.numeric))
nums
campx$FH_REF<-as.numeric(campx$FH_REF)
campx<-camp
campx$FH_REF<-as.numeric(campx$FH_REF)
nums <- unlist(lapply(campx, is.numeric))
nums
corrplot(cor(campx[,nums]))
campx<-camp
campx$FH_REF<-as.numeric(campx$FH_REF)
names(campx) <- c("mes","seg","target","num_ctes","cargos","n_prods","necesidad","saldo","cat")
nums <- unlist(lapply(campx, is.numeric))
corrplot(cor(campx[,nums]))
campx
names(campx)
names(camp)
campx<-camp
campx$FH_REF<-as.numeric(campx$FH_REF)
names(campx) <- c("mes","seg","target","num_ctes","cargos","n_prods","necesidad","gastos","saldo","cat")
nums <- unlist(lapply(campx, is.numeric))
corrplot(cor(campx[,nums]))
corrplot(cor(campx[,nums]))
pairs(camp[,nums])
pairs(campx[,nums])
library(corrplot)
campx<-camp
campx$FH_REF<-as.numeric(campx$FH_REF)
names(campx) <- c("mes","seg","target","num_ctes","cargos","n_prods","necesidad","gastos","saldo","cat")
nums <- unlist(lapply(campx, is.numeric))
corrplot(cor(campx[,nums]))
ggplot(campx, aes(mes)) +
geom_line(aes(y = gastos, colour = "var0")) +
geom_line(aes(y = n_prods, colour = "var1"))
ggplot(campx, aes(mes)) +
geom_line(aes(y = scale(gastos), colour = "var0")) +
geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(campx, aes(mes)) +
geom_line(aes(y = scale(gastos), colour = "var0"))
#+
# geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(campx, aes(mes)) + geom_line(aes(y = scale(gastos)))
ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "var0"))
ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "gastos"))
ggplot(campx,aes(x=mes)) + geom_line(y = scale(gastos),col="blue")
ggplot(campx,aes(x=mes)) + geom_line(aes(y = scale(gastos)),col="blue")
#ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "gastos"))
#+
# geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(campx,aes(x=as.Date(FH_REF))) + geom_line(,y=total,col="blue")
ggplot(campx,aes(x=as.Date(FH_REF))) + geom_line(y=total,col="blue")
ggplot(camp,aes(x=as.Date(FH_REF))) + geom_line(y=total,col="blue")
ggplot(tot,aes(x=as.Date(FH_REF))) + geom_line(y=total,col="blue")
View(tot)
names(campx)
totp<-campx %>% group_by(mes)%>%summarise(total=sum(target),ctes=sum(num_ctes),cargos=mean(cargos),n?prods=mean(n_prods),necesidad=mean(necesidad),gastos=mean(gastos),saldo=mean(saldo))
totp<-campx %>% group_by(mes)%>%summarise(total=sum(target),ctes=sum(num_ctes),cargos=mean(cargos),n_prods=mean(n_prods),necesidad=mean(necesidad),gastos=mean(gastos),saldo=mean(saldo))
View(totp)
+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))
View(totp)
+ geom_line(aes(y = scale(n_prods), colour = "var1"))
totp<-campx %>% group_by(mes)%>%summarise(total=sum(target),ctes=sum(num_ctes),cargos=mean(cargos),n_prods=mean(n_prods),necesidad=mean(necesidad),gastos=mean(gastos),saldo=mean(saldo))
#ggplot(tot,aes(x=as.Date(FH_REF))) + geom_line(y=total,col="blue")
ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "var0"))
#+ geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "var0"))
+ geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(gastos), colour = "var0")) +
geom_line(aes(y = scale(n_prods), colour = "var1"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
facet_wrap(~seg)
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
facet_wrap(~seg)
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
facet_wrap(~cat)
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos",group = seg))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos",group = seg))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(campx, aes(x=as.Date(FH_REF))) + geom_line(aes(y = scale(num_ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos",group = seg))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(target), colour = "contrataciones"))
ggplot(campx, aes(x=mes)) + geom_line(aes(y = scale(num_ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos",group = seg))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(target), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos",group = seg))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
geom_line(aes(y = scale(total), colour = "contrataciones"))
View(totp)
?scale
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos,scale = FALSE), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
#geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
geom_line(aes(y = scale(total), colour = "contrataciones"))
?normalizePath
?minmax
??minmax
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos,scale = FALSE), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
geom_line(aes(y = scale(total), colour = "contrataciones"))
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos,scale = FALSE), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
geom_line(aes(y = scale(total), colour = "contrataciones"))+
ylab('Valores')
library(tidyverse)
library(R2jags)
library(forcats)
#library(plyr)
prob<-function(x){
out<-min(length(x[x>0])/length(x),length(x[x<0])/length(x))
out
}
library(dplyr)
camp<-read.csv('segt-1.csv',header=TRUE,sep=",")
camp<-select(camp,-X)
camp<-camp %>% mutate(cat=as.numeric(camp$TP_SEGMENTO_FINAL2))
#camp<-arrange(camp,cat)
tot<-camp %>% group_by(FH_REF)%>%summarise(total=sum(target),ctes=sum(ID))%>%mutate(tasa=(total/ctes))
ggplot(tot,aes(x=as.Date(FH_REF),y=total)) + geom_line(col="blue") +geom_point()+
xlab("Fecha") +
ylab("Creditos contratados")+theme_minimal()
ggplot(tot,aes(x=as.Date(FH_REF),y=tasa)) + geom_line(col="red") +geom_point()+
xlab("Fecha") +
ylab("Tasa")+theme_minimal()
ggplot(camp, aes(x = as.Date(FH_REF), y = target)) +
geom_line(aes(color = TP_SEGMENTO_FINAL2,
group = TP_SEGMENTO_FINAL2)) +
guides(color = guide_legend(title = "Segmento"))+
ylab('Créditos contratados') +
xlab('Fecha') + theme_minimal()
ggplot(camp,aes(x=as.Date(FH_REF),y=target)) + geom_line(col="red") +facet_wrap(~TP_SEGMENTO_FINAL2)+
xlab("Fecha") +
ylab("Creditos contratados")+theme(axis.text.x = element_text(angle=90))
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, target), y=target,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()+xlab('Segmento')+ylab('Créditos contratados')
ggplot(camp, aes(x=fct_reorder(TP_SEGMENTO_FINAL2, ID), y=ID,fill=TP_SEGMENTO_FINAL2)) +
geom_boxplot() + coord_flip()+xlab('Segmento')+ylab('Número de Clientes')
# Tabla resumen
camp %>%
group_by(TP_SEGMENTO_FINAL2) %>%mutate(tasa=(target/ID))%>%
summarise(mediana = median(target),
promedio = mean(target),tasa_promedio=mean(tasa)*100)  %>%
ungroup %>%
mutate(TP_SEGMENTO_FINAL2 = fct_reorder(TP_SEGMENTO_FINAL2, promedio)) %>%
arrange(desc(TP_SEGMENTO_FINAL2))
library(corrplot)
campx<-camp
campx$FH_REF<-as.numeric(campx$FH_REF)
names(campx) <- c("mes","seg","target","num_ctes","cargos","n_prods","necesidad","gastos","saldo","cat")
nums <- unlist(lapply(campx, is.numeric))
corrplot(cor(campx[,nums]))
totp<-campx %>% group_by(mes)%>%summarise(total=sum(target),ctes=sum(num_ctes),cargos=mean(cargos),n_prods=mean(n_prods),necesidad=mean(necesidad),gastos=mean(gastos),saldo=mean(saldo))
#ggplot(tot,aes(x=as.Date(FH_REF))) + geom_line(y=total,col="blue")
ggplot(totp, aes(x=mes)) + geom_line(aes(y = scale(ctes), colour = "ctes")) +
geom_line(aes(y = scale(cargos,scale = FALSE), colour = "cargos"))+
geom_line(aes(y = scale(n_prods), colour = "n_prods"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(necesidad), colour = "necesidad"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(gastos), colour = "gastos"))+
geom_line(aes(y = scale(cargos), colour = "cargos"))+
geom_line(aes(y = scale(saldo), colour = "saldo"))+
geom_point(aes(y = scale(total), colour = "contrataciones"))+
geom_line(aes(y = scale(total), colour = "contrataciones"))+
ylab('Valores')
tot<-8+7+5.5+5+4.5+4+3.5+2.5
tot
8/40
7/40
5.5/40
5/40
4.5/4
4.5/40
100+70*2+40*3+60*2+30
170/510
